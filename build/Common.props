<Project>
  <PropertyGroup>
    <!-- Game Information -->
    <GameName>City of Gangsters</GameName>
    <GameAssembly>Assembly-CSharp</GameAssembly>
    <GamePublisher>SomaSim</GamePublisher>
    
    <!-- Build Configuration -->
    <TargetFramework>net48</TargetFramework>
    <LangVersion>latest</LangVersion>
    <Nullable>enable</Nullable>
    <GenerateAssemblyInfo>false</GenerateAssemblyInfo>
    
    <!-- BepInEx Configuration -->
    <BepInExVersion>5.4.21</BepInExVersion>
    
    <!-- Output Configuration -->
    <OutputType>Library</OutputType>
    <DebugType>portable</DebugType>
    <DebugSymbols>true</DebugSymbols>
    <OutputPath>$(SolutionDir)bin\$(Configuration)\$(MSBuildProjectName)\</OutputPath>
    
    <!-- Assembly Metadata -->
    <AssemblyTitle>$(MSBuildProjectName)</AssemblyTitle>
    <AssemblyDescription>BepInEx mod for $(GameName)</AssemblyDescription>
    <AssemblyCompany>MrPurple6411</AssemblyCompany>
    <AssemblyProduct>$(GameName) Mod</AssemblyProduct>
    <AssemblyCopyright>Copyright Â© MrPurple6411 2025</AssemblyCopyright>
  </PropertyGroup>
  
  <!-- Game Assembly Paths (CORRECTED) -->
  <PropertyGroup>
    <GameDir Condition="'$(GameDir)' == '' AND Exists('C:\Program Files (x86)\Steam\steamapps\common\City of Gangsters')">C:\Program Files (x86)\Steam\steamapps\common\City of Gangsters</GameDir>
    <GameDir Condition="'$(GameDir)' == '' AND Exists('C:\Program Files\Steam\steamapps\common\City of Gangsters')">C:\Program Files\Steam\steamapps\common\City of Gangsters</GameDir>
    <GameDir Condition="'$(GameDir)' == '' AND Exists('$(MSBuildThisFileDirectory)..\..\GameDir')">$(MSBuildThisFileDirectory)..\..\GameDir</GameDir>
    
    <!-- Fixed paths: CoG.exe -> CoG_Data -->
    <ManagedDir>$(GameDir)\CoG_Data\Managed</ManagedDir>
    <BepInExDir>$(GameDir)\BepInEx</BepInExDir>
    <PluginsDir>$(BepInExDir)\plugins</PluginsDir>
  </PropertyGroup>
  
  <!-- BepInEx Plugin Configuration -->
  <PropertyGroup>
    <!-- Your preferred GUID format: mrpurple6411.cityofgangsters.modname -->
    <PluginGuid Condition="'$(PluginGuid)' == ''">mrpurple6411.cityofgangsters.$(MSBuildProjectName.ToLowerInvariant())</PluginGuid>
    <PluginName Condition="'$(PluginName)' == ''">$(MSBuildProjectName)</PluginName>
    <PluginVersion Condition="'$(PluginVersion)' == ''">1.0.0</PluginVersion>
  </PropertyGroup>
  
  <!-- Git Tag Version Extraction -->
  <PropertyGroup>
    <!-- Extract version from GitHub Actions -->
    <GitTag Condition="'$(GITHUB_REF_TYPE)' == 'tag'">$(GITHUB_REF_NAME)</GitTag>
    
    <!-- Individual mod tag: ModName-v1.2.3 -->
    <IsIndividualModTag Condition="$(GitTag.Contains('-v')) AND $(GitTag.StartsWith('$(MSBuildProjectName)-v'))">true</IsIndividualModTag>
    <ExtractedVersion Condition="'$(IsIndividualModTag)' == 'true'">$(GitTag.Substring($([MSBuild]::Add($(MSBuildProjectName.Length), 2))))</ExtractedVersion>
    
    <!-- Global tag: v1.2.3 -->
    <IsGlobalTag Condition="$(GitTag.StartsWith('v')) AND !$(GitTag.Contains('-'))">true</IsGlobalTag>
    <ExtractedVersion Condition="'$(IsGlobalTag)' == 'true'">$(GitTag.Substring(1))</ExtractedVersion>
    
    <!-- Override plugin version if tag matches -->
    <PluginVersion Condition="'$(ExtractedVersion)' != ''">$(ExtractedVersion)</PluginVersion>
  </PropertyGroup>
</Project>